{% macro counter(foo) %}
{% set level = level + 1 %}
{% if level < foo %}
{{ counter() }}
{% endif %}
{{ level }}
{% endmacro %}
{{ counter(deferred) }}

{{ counter(2) }}